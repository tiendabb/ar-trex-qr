<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>T-Rex AR</title>
  <!-- A-Frame y AR.js -->
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js" defer></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js" defer></script>

  <style>
    body, html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
      font-family: Arial, sans-serif;
      color: white;
    }

    /* Bot√≥n flotante para activar AR */
    #start-ar {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      padding: 16px 30px;
      font-size: 1.4em;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: 2px solid #fff;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
      z-index: 1000;
      backdrop-filter: blur(5px);
      transition: background 0.3s, transform 0.2s;
    }

    #start-ar:hover, #start-ar:active {
      background: rgba(255, 255, 255, 0.2);
      transform: translateX(-50%) scale(1.05);
    }

    /* Escena AR (oculta al inicio) */
    #ar-scene {
      display: none;
      width: 100%;
      height: 100%;
    }

    /* Estado del QR */
    #qr-status {
      position: absolute;
      bottom: 20px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 1.3em;
      color: yellow;
      z-index: 2000;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    #qr-status.visible {
      opacity: 1;
    }
  </style>
</head>
<body>

  <!-- Bot√≥n para activar AR (√∫nico elemento visible al inicio) -->
  <button id="start-ar">üëâ TOCAR PARA INICIAR REALIDAD AUMENTADA</button>

  <!-- Escena AR -->
  <div id="ar-scene">
    <a-scene
      embedded
      vr-mode-ui="enabled: false"
      renderer="logarithmicDepthBuffer: true; antialias: true;"
      arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix;"
    >
      <!-- Modelo 3D local -->
      <a-asset-item id="trex-model" src="trex.glb"></a-asset-item>

      <!-- Marcador QR -->
      <a-marker type="qr" value="trex-animado" id="trex-marker">
        <!-- T-Rex girando -->
        <a-entity
          position="0 0 0"
          scale="2.5 2.5 2.5"
          rotation="0 180 0"
          gltf-model="#trex-model"
          animation="property: rotation; to: 0 360 0; loop: true; dur: 4000; easing: linear"
        ></a-entity>
        <!-- Texto animado -->
        <a-text
          value="¬°T-Rex en AR!"
          color="yellow"
          position="0 1.6 0"
          animation="property: position; to: 0 1.9 0; loop: true; dur: 1500; dir: alternate"
        ></a-text>
      </a-marker>

      <!-- C√°mara -->
      <a-entity camera></a-entity>
    </a-scene>

    <!-- Mensaje de estado del QR -->
    <div id="qr-status">üîç Escaneando c√≥digo QR...</div>
  </div>

  <script>
    const startBtn = document.getElementById('start-ar');
    const arScene = document.getElementById('ar-scene');
    const qrStatus = document.getElementById('qr-status');

    // === Activar AR al tocar el bot√≥n ===
    startBtn.addEventListener('click', () => {
      startBtn.style.display = 'none'; // Ocultar bot√≥n
      arScene.style.display = 'block'; // Mostrar escena AR
    });

    // === Detectar si el QR est√° visible ===
    function checkQRStatus() {
      const marker = document.querySelector('a-marker');
      if (marker) {
        if (marker.getAttribute('visible')) {
          qrStatus.textContent = '‚úÖ ¬°QR detectado! T-Rex visible';
          qrStatus.classList.add('visible');
        } else {
          qrStatus.textContent = 'üîç Escaneando c√≥digo QR...';
          qrStatus.classList.remove('visible');
        }
      }
      setTimeout(checkQRStatus, 500); // Repetir
    }

    // === Iniciar escucha del QR al cargar ===
    window.onload = () => {
      checkQRStatus();
    };
  </script>
</body>
</html>
